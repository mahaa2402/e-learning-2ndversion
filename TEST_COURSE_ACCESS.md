# Testing Course Access in Development

## Step-by-Step Guide

### 1. Start the Backend Server

Open a terminal and navigate to the backend directory:

```bash
cd backend
npm install  # If you haven't already
npm run dev  # or npm start
```

The backend should start on `http://localhost:5000`

### 2. Start the Frontend Development Server

Open a **new terminal** and navigate to the frontend directory:

```bash
cd frontend
npm install  # If you haven't already
npm start
```

The frontend should start on `http://localhost:3000` and automatically open in your browser.

### 3. Generate a Test Course Access Token

Open a **third terminal** and run:

```bash
cd backend
node test-course-access.js
```

This will generate a test token and display a link like:
```
http://localhost:3000/course-access?token=...
```

### 4. Test the Course Access Link

**Option A: Use the generated link**
- Copy the link from step 3
- Paste it in your browser
- It should validate the token and redirect to `/userdashboard`

**Option B: Create a real assignment and use the email link**
1. Log in as admin
2. Go to "Assign Task" page
3. Assign a task to an employee
4. Check the email (or console logs if email service isn't configured)
5. Click the "Start Course Now" button in the email

### 5. Verify the Flow

When you click the course access link, you should see:

1. **Loading state**: "Validating access link..." with a spinner
2. **Success**: Automatic redirect to `/userdashboard`
3. **Error (if token invalid)**: Error message with "Go to Login" button

### 6. Test Different Scenarios

**Test Valid Token:**
- Use the link generated by `test-course-access.js`
- Should redirect to dashboard

**Test Expired Token:**
- Modify `test-course-access.js` to set deadline in the past
- Generate new token
- Should show "Invalid or expired access link" error

**Test Invalid Token:**
- Manually modify the token in the URL
- Should show error message

**Test Missing Token:**
- Visit `http://localhost:3000/course-access` without token
- Should show "No access token provided" error

## Troubleshooting

### Route Not Found Error
- Make sure you've saved `AppRoutes.js` with the `/course-access` route
- Restart the frontend dev server: `Ctrl+C` then `npm start`

### Backend API Error
- Check backend is running on port 5000
- Check console for errors
- Verify `.env` file has `JWT_SECRET` set

### Token Validation Fails
- Check that `JWT_SECRET` in `.env` matches what was used to generate token
- Verify the token hasn't expired (deadline check)
- Check backend console for validation errors

### Redirect Not Working
- Check browser console for errors
- Verify `/userdashboard` route exists
- Check that `navigate()` is being called correctly

## Expected Console Output

**Backend (when validating token):**
```
âœ… Valid token for test@example.com - Course: Food Safety
```

**Frontend (in browser console):**
```
ðŸ”§ API Configuration: {...}
ðŸš€ Using API URL: http://localhost:5000/api
```

## Quick Test Command

To quickly test everything is working:

```bash
# Terminal 1: Backend
cd backend && npm run dev

# Terminal 2: Frontend  
cd frontend && npm start

# Terminal 3: Generate test link
cd backend && node test-course-access.js
```

Then copy and paste the generated link into your browser!

